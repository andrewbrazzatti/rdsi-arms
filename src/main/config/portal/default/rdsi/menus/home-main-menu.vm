<div class="grid_3">
    <ul class="menu-btn">
        <li>
           <input id="new-request" class="menu-button" type="button" value='#displayMessage("arms.home.menu.newarmssubmission")'></input>
        </li>
    </ul>
</div>
## make pakgeType portalId dependent
#if ($portalId == "default") #set($nodeSuffix = "") #else #set($nodeSuffix = "-$portalId") #end
<script type="text/javascript">
$(function() {
    var jQ = $;
    var processing = false;
    jQ("#new-request").click(function() {
        if (processing) return;
        processing = true;
        jQ("#new-request").append('<img class="right" src="$portalPath/images/icons/loading.gif" />');
        jQ.ajax({
            type: "POST",
            url: "$portalPath/actions/packaging.ajax",
            data: {
                ajax: 1,
                func: "create-new",
                packageType: "arms$nodeSuffix",
                metaList: ["title", "description", "redbox:newForm", "redbox:formVersion","node"],
                sequencesMetaList: [ '{ "sequenceName":"qcloudRequest","metadataName": "requestID","stringFormat":"QCloud_%04d"}'],
                title: "[Untitled]",
                node: "RDSI$nodeSuffix",
                description: "",
                "redbox:newForm": "true",
                "redbox:formVersion": "$systemConfig.getString("", "redbox.version.string")"
            },
            success: function(data) {
                if (data.status == "ok") {
                    function redirect() {
                        window.location.href = data.url;
                    }
                    setTimeout(redirect, 1500);
                } else {
                    alert("#displayMessage('error-record-create-failed')");
                }
            },
            error: function(xhr, status, e) {
                alert("#displayMessage('error-record-create-failed')");
            },
            dataType: "json"
        });
        return false;
    });
});

</script>
